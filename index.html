<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="We align lyric-to-melody LLMs with rule-based musical constraints, using sequential DPO and KTO to reduce musical hallucinations and improve melody quality.">
  <meta name="keywords" content="lyric-to-melody generation, large language models, preference alignment, musical constraints, direct preference optimization">
  <meta name="author" content="Hao Meng, Siyuan Zheng, Shuran Zhou, Qiangqiang Wang, Yang Song">
  <meta property="og:type" content="article">
  <meta property="og:title" content="Aligning Language Models for Lyric-to-Melody Generation with Rule-Based Musical Constraints">
  <meta property="og:description" content="We align lyric-to-melody LLMs with rule-based musical constraints, using sequential DPO and KTO to reduce musical hallucinations and improve melody quality.">
  <meta property="og:url" content="index.html">
  <meta property="og:image" content="static/image/2-1.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Aligning Language Models for Lyric-to-Melody Generation with Rule-Based Musical Constraints">
  <meta name="twitter:description" content="We align lyric-to-melody LLMs with rule-based musical constraints, using sequential DPO and KTO to reduce musical hallucinations and improve melody quality.">
  <meta name="twitter:image" content="static/image/2-1.jpg">
  <meta name="citation_title" content="Aligning Language Models for Lyric-to-Melody Generation with Rule-Based Musical Constraints">
  <meta name="citation_author" content="Meng, Hao">
  <meta name="citation_author" content="Zheng, Siyuan">
  <meta name="citation_author" content="Zhou, Shuran">
  <meta name="citation_author" content="Wang, Qiangqiang">
  <meta name="citation_author" content="Song, Yang">
  <meta name="citation_publication_date" content="2026">
  <meta name="citation_pdf_url" content="static/pdf/manuscript.pdf">
  <title>Aligning LMs for Lyric-to-Melody Generation</title>

  <link rel="icon" type="image/x-icon" href="static/image/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">
            ALIGNING LANGUAGE MODELS FOR LYRIC-TO-MELODY GENERATION WITH RULE-BASED MUSICAL CONSTRAINTS
          </h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">Hao Meng</span>
            <span class="author-block">Siyuan Zheng</span>
            <span class="author-block">Shuran Zhou</span>
            <span class="author-block">Qiangqiang Wang</span>
            <span class="author-block">Yang Song</span>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block">Zuoyebang Education Technology, Beijing, China</span>
            <span class="author-block">{menghao05, zhengsiyuan02, zhoushuran, wangqiangqiang, songyang}@zuoyebang.com</span>
          </div>
          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="static/pdf/manuscript.pdf" target="_blank" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <div class="columns is-centered">
        <div class="column is-10">
          <figure class="image">
            <img src="static/image/2-1.jpg" alt="Overall framework of the proposed method"/>
          </figure>
          <h2 class="subtitle has-text-centered">
            The overall framework of our proposed method: SFT, rule-based preference data generation, then sequential DPO and KTO alignment.
          </h2>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Large Language Models (LLMs) show promise in lyric-to-melody generation, but models trained with Supervised Fine-Tuning (SFT) often produce musically implausible melodies with issues like poor rhythm and unsuitable vocal ranges, a phenomenon we term "musical hallucination". To address this, we propose a novel alignment framework that instills musical knowledge without human annotation. We define rule-based musical constraints to automatically generate a preference dataset from an SFT model's outputs. The model is then aligned through a sequential process, first using Direct Preference Optimization (DPO) on paired preference data, followed by Kahneman-Tversky Optimization (KTO) on unpaired negative samples. Experimental results demonstrate that our aligned model significantly reduces rule violations and outperforms strong baselines in both objective and subjective evaluations, generating melodies with substantially improved musicality and coherence.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="content">
      <h2 class="title is-3 has-text-centered">Keywords</h2>
      <p class="has-text-centered">Lyric-to-melody generation, large language models, preference alignment, musical constraints, direct preference optimization</p>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop content">
    <h2 class="title is-3 has-text-centered">Audio Demos</h2>  <!-- 改成复数，更准确 -->

    <!-- Case 1 -->
    <h3 class="title is-4 has-text-centered mt-6">Case 1: nothing left look don't get me wrong i know</h3>
    <p class="has-text-centered subtitle is-6 mb-5">
      Four different models/pipelines for lyric-to-melody + singing voice synthesis.
    </p>

    <!-- Ground Truth 放在最上面，居中突出 -->
    <div class="columns is-centered">
      <div class="column is-10-tablet is-8-desktop">
        <div class="box has-text-centered has-background-light">
          <p class="title is-5 has-text-primary mb-3">Ground Truth (Human Reference)</p>
          <audio controls style="width: 100%; max-width: 600px; margin: 1.5rem auto; display: block;">
            <source src="static/audio/gt_en_01.wav" type="audio/wav">
            <source src="static/audio/case1_gt.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
          <p class="is-size-6 has-text-grey mt-2">Original / human-sung version for comparison</p>
        </div>
      </div>
    </div>
    
    <div class="columns is-centered is-multiline">
      <!-- Model 1: Step-Audio -->
      <div class="column is-12-tablet is-6-desktop">
        <div class="box has-text-centered">
          <p class="title is-5 mb-3">Step-Audio</p>
          <p class="subtitle is-6 has-text-grey mt-1 mb-4">(Step-by-step audio generation baseline)</p>
          <audio controls style="width: 100%; max-width: 480px; margin: 1.5rem auto; display: block;">
            <source src="static/audio/stepaudio_en_01.wav" type="audio/wav">
            <source src="static/audio/stepaudio_1.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
      </div>

      <!-- Model 2: CosyVoice -->
      <div class="column is-12-tablet is-6-desktop">
        <div class="box has-text-centered">
          <p class="title is-5 mb-3">ReLyMe (Improved TeleMelody)</p>
          <p class="subtitle is-6 has-text-grey mt-1 mb-4">(RelyMe model for melody generation)</p>
          <audio controls style="width: 100%; max-width: 480px; margin: 1.5rem auto; display: block;">
            <source src="static/audio/relyme_en_01.wav" type="audio/wav">
            <source src="static/audio/cosyvoice_1.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
      </div>

      <!-- Model 3: Lyric2Melody + TechSinger -->
      <div class="column is-12-tablet is-6-desktop">
        <div class="box has-text-centered">
          <p class="title is-5 mb-3">SongComposer</p>
          <p class="subtitle is-6 has-text-grey mt-1 mb-4">(Song composition pipeline)</p>
          <audio controls style="width: 100%; max-width: 480px; margin: 1.5rem auto; display: block;">
            <source src="static/audio/songcomposer_en_01.wav" type="audio/wav">
            <source src="static/audio/techsinger_1.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
      </div>

      <!-- Model 4: Lyric2Melody + DiffSinger -->
      <div class="column is-12-tablet is-6-desktop">
        <div class="box has-text-centered">
          <p class="title is-5 mb-3">Ours (Proposed)</p>
          <p class="subtitle is-6 has-text-grey mt-1 mb-4">(Aligned with rule-based musical constraints)</p>
          <audio controls style="width: 100%; max-width: 480px; margin: 1.5rem auto; display: block;">
            <source src="static/audio/ours_en_01.wav" type="audio/wav">
            <source src="static/audio/diffsinger_1.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
      </div>
    </div>

    <!-- Case 2 -->
    <h3 class="title is-4 has-text-centered mt-6">Case 2: 是让我笑到最后</h3>
    <p class="has-text-centered subtitle is-6 mb-5">
      Four different models/pipelines for lyric-to-melody + singing voice synthesis.
    </p>

    <!-- Ground Truth 放在最上面，居中突出 -->
    <div class="columns is-centered">
      <div class="column is-10-tablet is-8-desktop">
        <div class="box has-text-centered has-background-light">
          <p class="title is-5 has-text-primary mb-3">Ground Truth (Human Reference)</p>
          <audio controls style="width: 100%; max-width: 600px; margin: 1.5rem auto; display: block;">
            <source src="static/audio/gt_zh_05.wav" type="audio/wav">
            <source src="static/audio/case1_gt.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
          <p class="is-size-6 has-text-grey mt-2">Original / human-sung version for comparison</p>
        </div>
      </div>
    </div>
    
    <div class="columns is-centered is-multiline">
      <!-- 同上四个模型，文件名改成 _5.wav -->
      <div class="column is-12-tablet is-6-desktop">
        <div class="box has-text-centered">
          <p class="title is-5 mb-3">Step-Audio</p>
          <p class="subtitle is-6 has-text-grey mt-1 mb-4">(Step-by-step audio generation baseline)</p>
          <audio controls style="width: 100%; max-width: 480px; margin: 1.5rem auto; display: block;">
            <source src="static/audio/stepaudio_zh_05.wav" type="audio/wav">
            <source src="static/audio/stepaudio_5.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
      </div>

      <!-- Model 2: CosyVoice -->
      <div class="column is-12-tablet is-6-desktop">
        <div class="box has-text-centered">
          <p class="title is-5 mb-3">ReLyMe (Improved TeleMelody)</p>
          <p class="subtitle is-6 has-text-grey mt-1 mb-4">(RelyMe model for melody generation)</p>
          <audio controls style="width: 100%; max-width: 480px; margin: 1.5rem auto; display: block;">
            <source src="static/audio/relyme_en_05.wav" type="audio/wav">
            <source src="static/audio/cosyvoice_5.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
      </div>

      <!-- Model 3: Lyric2Melody + TechSinger -->
      <div class="column is-12-tablet is-6-desktop">
        <div class="box has-text-centered">
          <p class="title is-5 mb-3">SongComposer</p>
          <p class="subtitle is-6 has-text-grey mt-1 mb-4">(Song composition pipeline)</p>
          <audio controls style="width: 100%; max-width: 480px; margin: 1.5rem auto; display: block;">
            <source src="static/audio/songcomposer_zh_05.wav" type="audio/wav">
            <source src="static/audio/techsinger_5.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
      </div>

      <!-- Model 4: Lyric2Melody + DiffSinger -->
      <div class="column is-12-tablet is-6-desktop">
        <div class="box has-text-centered">
          <p class="title is-5 mb-3">Ours (Proposed)</p>
          <p class="subtitle is-6 has-text-grey mt-1 mb-4">(Aligned with rule-based musical constraints)</p>
          <audio controls style="width: 100%; max-width: 480px; margin: 1.5rem auto; display: block;">
            <source src="static/audio/ours_zh_05.wav" type="audio/wav">
            <source src="static/audio/diffsinger_5.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
      </div>
    </div>
    </div>

    <!-- 全局额外说明，放在最下面 -->
    <div class="has-text-centered mt-6">
      <p class="is-size-6 has-text-grey">
        All generated from the same lyrics without cherry-picking.<br>
        Listen with headphones for best experience. WAV format for highest fidelity.
      </p>
    </div>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a>.
            This website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
